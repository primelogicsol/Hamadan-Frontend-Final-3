<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Book Management System</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastify-js/1.12.0/toastify.min.css">
 
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    
    :root {
        --primary: #6d28d9;
        --primary-light: #8b5cf6;
        --primary-dark: #5b21b6;
        --secondary: #10b981;
        --dark-bg: #0f172a;
        --darker-bg: #0a0f1c;
        --card-bg: #1e293b;
        --text-color: #f1f5f9;
        --text-muted: #94a3b8;
        --border-color: rgba(255, 255, 255, 0.06);
        --transition-speed: 0.3s;
        --glow-color: rgba(109, 40, 217, 0.5);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;
    }

    body {
        background-color: var(--darker-bg);
        color: var(--text-color);
        overflow-x: hidden;
        min-height: 100vh;
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 2rem;
        background-color: var(--dark-bg);
        height: 70px;
        position: fixed;
        width: 100%;
        top: 0;
        z-index: 1000;
        box-shadow: 0 3px 20px rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(10px);
        transition: all var(--transition-speed) ease;
        border-bottom: 1px solid var(--border-color);
    }

    .header:hover {
        box-shadow: 0 5px 25px rgba(109, 40, 217, 0.3);
    }

    /* Logo */
    .logo {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 700;
        font-size: 1.5rem;
        color: var(--primary-light);
        text-decoration: none;
        position: relative;
        z-index: 2;
    }

    .logo-icon {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 40px;
        width: 40px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        border-radius: 12px;
        box-shadow: 0 0 15px rgba(109, 40, 217, 0.5);
        position: relative;
        overflow: hidden;
        transition: all 0.5s ease;
    }

    .logo-icon::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: conic-gradient(from 0deg, transparent 0%, transparent 30%, rgba(255, 255, 255, 0.3) 40%, transparent 50%);
        animation: rotate 4s linear infinite;
    }

    @keyframes rotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .logo-icon svg {
        height: 22px;
        width: 22px;
        fill: white;
        z-index: 2;
    }

    .logo span {
        background: linear-gradient(90deg, var(--primary-light), #d8b4fe);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-weight: 700;
    }

    /* Navigation */
    .nav-container {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .nav-links {
        display: flex;
        gap: 0.25rem;
        position: relative;
    }

    .nav-item {
        position: relative;
        padding: 0.75rem 1rem;
        color: var(--text-color);
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        border-radius: 12px;
        transition: all var(--transition-speed) cubic-bezier(0.34, 1.56, 0.64, 1);
        font-weight: 500;
        font-size: 0.95rem;
        z-index: 2;
        overflow: hidden;
    }

    .nav-item::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, rgba(109, 40, 217, 0.1), rgba(139, 92, 246, 0.1));
        opacity: 0;
        transition: opacity 0.4s ease;
        z-index: -1;
        border-radius: 12px;
    }

    .nav-item:hover::before, .nav-item.active::before {
        opacity: 1;
    }

    .nav-item.active {
        color: var(--primary-light);
        font-weight: 600;
    }

    .nav-item:hover {
        transform: translateY(-3px);
        color: var(--primary-light);
    }

    .nav-item .nav-icon {
        width: 22px;
        height: 22px;
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        position: relative;
    }

    .nav-item:hover .nav-icon, .nav-item.active .nav-icon {
        fill: var(--primary-light);
        transform: scale(1.1);
    }

    /* Active indicator */
    .active-bg {
        position: absolute;
        background: linear-gradient(to right, rgba(109, 40, 217, 0.2), rgba(139, 92, 246, 0.1));
        border-radius: 12px;
        z-index: 1;
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        box-shadow: 0 5px 15px rgba(109, 40, 217, 0.2);
    }

    /* Notification badge */
    .notification-badge {
        position: absolute;
        top: 0;
        right: 0;
        background: var(--secondary);
        color: white;
        border-radius: 50%;
        width: 18px;
        height: 18px;
        font-size: 0.65rem;
        display: flex;
        justify-content: center;
        align-items: center;
        transform: translate(25%, -25%);
        box-shadow: 0 2px 5px rgba(16, 185, 129, 0.5);
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% { transform: translate(25%, -25%) scale(1); }
        50% { transform: translate(25%, -25%) scale(1.1); }
        100% { transform: translate(25%, -25%) scale(1); }
    }

    /* Search box */
    .search-box {
        position: relative;
        margin-right: 1rem;
    }

    .search-input {
        background-color: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 0.5rem 1rem 0.5rem 2.5rem;
        color: var(--text-color);
        font-size: 0.9rem;
        transition: all 0.3s ease;
        width: 200px;
    }

    .search-input:focus {
        outline: none;
        background-color: rgba(255, 255, 255, 0.1);
        border-color: var(--primary-light);
        box-shadow: 0 0 0 2px rgba(109, 40, 217, 0.2);
        width: 250px;
    }

    .search-icon {
        position: absolute;
        left: 10px;
        top: 50%;
        transform: translateY(-50%);
        fill: var(--text-muted);
        width: 16px;
        height: 16px;
        pointer-events: none;
        transition: all 0.3s ease;
    }

    .search-input:focus + .search-icon {
        fill: var(--primary-light);
    }

    /* User profile */
    .user-profile {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        cursor: pointer;
        padding: 0.5rem;
        border-radius: 12px;
        transition: all 0.3s ease;
        border: 1px solid transparent;
    }

    .user-profile:hover {
        background-color: rgba(255, 255, 255, 0.05);
        border-color: var(--border-color);
    }

    .avatar {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: linear-gradient(135deg, #3b82f6, #8b5cf6);
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-weight: 600;
        font-size: 1.2rem;
        box-shadow: 0 3px 10px rgba(59, 130, 246, 0.3);
        position: relative;
        overflow: hidden;
    }

    .avatar::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.3), transparent);
        animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
    }

    .user-info {
        display: flex;
        flex-direction: column;
    }

    .user-name {
        font-weight: 600;
        font-size: 0.95rem;
    }

    .user-role {
        font-size: 0.8rem;
        color: var(--text-muted);
    }

    /* Mobile menu */
    .menu-toggle {
        display: none;
        flex-direction: column;
        justify-content: space-between;
        width: 30px;
        height: 21px;
        cursor: pointer;
        z-index: 10;
    }

    .menu-toggle span {
        display: block;
        height: 3px;
        width: 100%;
        border-radius: 3px;
        background-color: var(--text-color);
        transition: all 0.3s cubic-bezier(0.68, -0.6, 0.32, 1.6);
    }

    .menu-toggle.active span:nth-of-type(1) {
        transform: rotate(45deg) translate(5px, 6px);
        background-color: var(--primary-light);
    }

    .menu-toggle.active span:nth-of-type(2) {
        opacity: 0;
    }

    .menu-toggle.active span:nth-of-type(3) {
        transform: rotate(-45deg) translate(5px, -6px);
        background-color: var(--primary-light);
    }

    /* Content placeholder */
    .content {
        margin-top: 100px;
        padding: 2rem;
        text-align: center;
    }

    /* Tooltip */
    .tooltip {
        position: absolute;
        background-color: var(--dark-bg);
        color: white;
        padding: 0.5rem 0.75rem;
        border-radius: 6px;
        font-size: 0.8rem;
        bottom: -40px;
        opacity: 0;
        pointer-events: none;
        transition: all 0.3s ease;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        border: 1px solid var(--border-color);
        white-space: nowrap;
    }

    .tooltip::before {
        content: '';
        position: absolute;
        top: -5px;
        left: 50%;
        transform: translateX(-50%);
        border-width: 0 5px 5px 5px;
        border-style: solid;
        border-color: transparent transparent var(--dark-bg) transparent;
    }

    .nav-item:hover .tooltip {
        opacity: 1;
        bottom: -35px;
    }

    /* Theme toggle */
    .theme-toggle {
        margin-left: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 10px;
        background-color: rgba(255, 255, 255, 0.05);
        cursor: pointer;
        transition: all 0.3s ease;
        border: 1px solid var(--border-color);
    }

    .theme-toggle:hover {
        background-color: rgba(255, 255, 255, 0.1);
        transform: rotate(15deg);
    }

    .theme-icon {
        width: 20px;
        height: 20px;
        fill: var(--text-muted);
        transition: all 0.3s ease;
    }

    .theme-toggle:hover .theme-icon {
        fill: var(--primary-light);
    }

    /* Responsive design */
    @media (max-width: 1200px) {
        .search-box {
            display: none;
        }
        
        .nav-item span {
            display: none;
        }
        
        .nav-item {
            padding: 0.75rem;
        }
        
        .tooltip {
            display: none;
        }
    }

    @media (max-width: 992px) {
        .user-info {
            display: none;
        }
    }

    @media (max-width: 768px) {
        .header {
            padding: 0 1rem;
        }
        
        .nav-container {
            position: static;
        }
        
        .nav-links {
            position: fixed;
            flex-direction: column;
            top: 70px;
            left: 0;
            width: 100%;
            background-color: var(--darker-bg);
            transform: translateY(-150%);
            transition: transform 0.5s cubic-bezier(0.68, -0.6, 0.32, 1.6);
            z-index: 9;
            padding: 1rem 0;
            gap: 0.5rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid var(--border-color);
        }
        
        .nav-links.active {
            transform: translateY(0);
        }
        
        .nav-item {
            width: 90%;
            margin: 0 auto;
            padding: 1rem;
            border-radius: 12px;
        }
        
        .nav-item span {
            display: inline;
        }
        
        .active-bg {
            display: none;
        }
        
        .menu-toggle {
            display: flex;
        }
        
        .theme-toggle, .user-profile {
            margin-left: auto;
        }
    }

    /* Entrance animations */
    @keyframes slideFromTop {
        0% {
            transform: translateY(-50px);
            opacity: 0;
        }
        100% {
            transform: translateY(0);
            opacity: 1;
        }
    }

    @keyframes slideFromRight {
        0% {
            transform: translateX(50px);
            opacity: 0;
        }
        100% {
            transform: translateX(0);
            opacity: 1;
        }
    }

    @keyframes slideFromLeft {
        0% {
            transform: translateX(-50px);
            opacity: 0;
        }
        100% {
            transform: translateX(0);
            opacity: 1;
        }
    }

    @keyframes fadeIn {
        0% {
            opacity: 0;
        }
        100% {
            opacity: 1;
        }
    }

    @keyframes popIn {
        0% {
            transform: scale(0.8);
            opacity: 0;
        }
        70% {
            transform: scale(1.1);
        }
        100% {
            transform: scale(1);
            opacity: 1;
        }
    }

    .nav-item {
        animation: slideFromTop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
    }

    .nav-item:nth-child(1) { animation-delay: 0.1s; }
    .nav-item:nth-child(2) { animation-delay: 0.15s; }
    .nav-item:nth-child(3) { animation-delay: 0.2s; }
    .nav-item:nth-child(4) { animation-delay: 0.25s; }
    .nav-item:nth-child(5) { animation-delay: 0.3s; }
    .nav-item:nth-child(6) { animation-delay: 0.35s; }
    .nav-item:nth-child(7) { animation-delay: 0.4s; }
    .nav-item:nth-child(8) { animation-delay: 0.45s; }

    .logo {
        animation: slideFromLeft 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
        animation-delay: 0.1s;
    }

    .search-box {
        animation: fadeIn 0.5s ease backwards;
        animation-delay: 0.3s;
    }

    .user-profile {
        animation: slideFromRight 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
        animation-delay: 0.2s;
    }

    .theme-toggle {
        animation: popIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
        animation-delay: 0.4s;
    }

    /* Icon animations */
    .nav-item:hover .nav-icon {
        animation: rubberBand 0.8s;
    }

    @keyframes rubberBand {
        0% { transform: scale(1); }
        30% { transform: scale(1.25, 0.75); }
        40% { transform: scale(0.75, 1.25); }
        50% { transform: scale(1.15, 0.85); }
        65% { transform: scale(0.95, 1.05); }
        75% { transform: scale(1.05, 0.95); }
        100% { transform: scale(1); }
    }

    /* Glow effect */
    .nav-item.active::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 30px;
        height: 10px;
        background: radial-gradient(ellipse at center, var(--glow-color) 0%, transparent 70%);
        animation: glow 2s infinite;
    }

    @keyframes glow {
        0% { opacity: 0.5; }
        50% { opacity: 1; }
        100% { opacity: 0.5; }
    }
</style>
 <style>
    :root {
    --primary-color: #6d28d9; /* Primary color */
    --primary-light: #8b5cf6; /* Light primary */
    --secondary-color: #10b981; /* Secondary color */
    --error-color: #dc2626; /* Error color */
    --dark-color: #1f2937; /* Dark background */
    --light-color: #e5e7eb; /* Light text */
    --border-radius: 8px; /* Border radius */
    --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Box shadow */
    --transition: all 0.3s ease; /* Transition speed */
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
}

body {
    background-color: #111827; /* Dark background */
    color: var(--light-color); /* Light text */
    line-height: 1.6;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

header {
    background-color: var(--dark-color); /* Dark background */
    color: var(--light-color); /* Light text */
    padding: 1rem;
    text-align: center;
    margin-bottom: 2rem;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
}

header h1 {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.book-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.book-card {
    background-color: var(--dark-color); /* Dark background */
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: var(--box-shadow);
    transition: var(--transition);
    position: relative;
}

.book-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

.book-card img {
    width: 100%;
    height: 200px;
    object-fit: contain;
}

.book-info {
    padding: 15px;
}

.book-title {
    font-weight: bold;
    font-size: 1.2rem;
    margin-bottom: 5px;
    color: var(--light-color); /* Light text */
}

.book-author, .book-category, .book-price {
    display: flex;
    align-items: center;
    gap: 5px;
    margin-bottom: 5px;
    font-size: 0.9rem;
    color: var(--light-color); /* Light text */
}

.book-price {
    font-weight: bold;
    color: var(--secondary-color); /* Secondary color */
}

.book-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 15px;
}

.action-button {
    background-color: var(--primary-color); /* Primary color */
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
    transition: var(--transition);
}

.action-button:hover {
    opacity: 0.9;
}

.action-button.delete {
    background-color: var(--error-color); /* Error color */
}

.action-button.view {
    background-color: var(--secondary-color); /* Secondary color */
}

/* Forms */
.form-container {
    background-color: var(--dark-color); /* Dark background */
    padding: 20px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-bottom: 30px;
}

.form-title {
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid var(--light-color); /* Light text */
    display: flex;
    align-items: center;
    gap: 10px;
}

.form-row {
    margin-bottom: 15px;
}

label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: var(--light-color); /* Light text */
}

input, select {
    width: 100%;
    padding: 10px;
    border: 1px solid #374151; /* Dark border */
    border-radius: 4px;
    font-size: 1rem;
    background-color: #1f2937; /* Dark background */
    color: var(--light-color); /* Light text */
}

input[type="file"] {
    padding: 8px;
}

.upload-preview {
    margin-top: 10px;
    display: none;
}

.upload-preview img {
    max-width: 100%;
    max-height: 200px;
    border-radius: 4px;
}

.submit-button {
    background-color: var(--secondary-color); /* Secondary color */
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: var(--transition);
    width: 100%;
    margin-top: 20px;
}

.submit-button:hover {
    opacity: 0.9;
}

/* Modal */
.modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 1000;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
}

.modal-container {
    background-color: var(--dark-color); /* Dark background */
    padding: 25px;
    border-radius: var(--border-radius);
    width: 90%;
    max-width: 500px;
    position: relative;
    max-height: 90vh;
    overflow-y: auto;
}

.close-modal {
    position: absolute;
    top: 15px;
    right: 15px;
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: var(--light-color); /* Light text */
}

/* Loading spinner */
.loader {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(255, 255, 255, 0.8);
    z-index: 2000;
    justify-content: center;
    align-items: center;
}

.spinner {
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-radius: 50%;
    border-top: 4px solid var(--primary-color); /* Primary color */
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Filters and search */
.filters {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-bottom: 20px;
    align-items: center;
}

.search-bar {
    flex: 1;
    position: relative;
    min-width: 250px;
}

.search-bar input {
    padding-left: 35px;
    background-color: #1f2937; /* Dark background */
    color: var(--light-color); /* Light text */
    border: 1px solid #374151; /* Dark border */
}

.search-icon {
    position: absolute;
    left: 10px;
    top: 10px;
    color: #94a3b8; /* Muted text */
}

.filter-select {
    min-width: 150px;
    background-color: #1f2937; /* Dark background */
    color: var(--light-color); /* Light text */
    border: 1px solid #374151; /* Dark border */
}

/* Empty state */
.empty-state {
    text-align: center;
    padding: 40px;
    background-color: var(--dark-color); /* Dark background */
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-top: 20px;
}

.empty-state i {
    font-size: 3rem;
    color: #94a3b8; /* Muted text */
    margin-bottom: 20px;
}

/* Confirmation dialog */
.confirm-dialog {
    text-align: center;
}

.confirm-buttons {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 20px;
}

.confirm-button {
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
    transition: var(--transition);
}

.confirm-yes {
    background-color: var(--error-color); /* Error color */
    color: white;
}

.confirm-no {
    background-color: var(--light-color); /* Light text */
    color: var(--dark-color); /* Dark background */
}

/* Book details view */
.book-details {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.book-details-image {
    width: 100%;
    border-radius: var(--border-radius);
    max-height: 300px;
    object-fit: contain;
}

.book-details-info h2 {
    margin-bottom: 15px;
    color: var(--light-color); /* Light text */
}

.book-detail-row {
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.book-detail-row i {
    min-width: 20px;
    color: var(--primary-color); /* Primary color */
}

.book-details-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

.pagination {
    display: flex;
    justify-content: center;
    margin-top: 30px;
    gap: 5px;
}

.page-button {
    padding: 8px 15px;
    border: 1px solid #374151; /* Dark border */
    background-color: var(--dark-color); /* Dark background */
    cursor: pointer;
    border-radius: 4px;
    transition: var(--transition);
    color: var(--light-color); /* Light text */
}

.page-button.active {
    background-color: var(--primary-color); /* Primary color */
    color: white;
    border-color: var(--primary-color); /* Primary color */
}

.page-button:hover:not(.active) {
    background-color: #374151; /* Dark border */
}

.stats-bar {
    display: flex;
    justify-content: space-between;
    background-color: var(--dark-color); /* Dark background */
    border-radius: var(--border-radius);
    padding: 15px;
    margin-bottom: 20px;
    box-shadow: var(--box-shadow);
}

.stat-item {
    text-align: center;
    flex: 1;
}

.stat-value {
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--primary-color); /* Primary color */
}

.stat-label {
    font-size: 0.9rem;
    color: #94a3b8; /* Muted text */
}

/* File upload button styling */
.file-input-container {
    position: relative;
    overflow: hidden;
}

.file-input-button {
    display: inline-block;
    background-color: #374151; /* Dark border */
    color: var(--light-color); /* Light text */
    padding: 10px 15px;
    border-radius: 4px;
    cursor: pointer;
    border: 1px solid #374151; /* Dark border */
    text-align: center;
    width: 100%;
}

.file-input {
    position: absolute;
    left: 0;
    top: 0;
    opacity: 0;
    width: 100%;
    height: 100%;
    cursor: pointer;
}

.file-name {
    margin-top: 5px;
    font-size: 0.9rem;
    color: #94a3b8; /* Muted text */
    word-break: break-all;
}

.badge {
    display: inline-block;
    padding: 3px 8px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: bold;
    text-transform: uppercase;
}

.badge-best-practices {
    background-color: var(--primary-color); /* Primary color */
    color: white;
}

.badge-case-studies {
    background-color: var(--secondary-color); /* Secondary color */
    color: white;
}

.badge-research-papers {
    background-color: #8b5cf6; /* Light primary */
    color: white;
}

.badge-e-book {
    background-color: #f59e0b; /* Accent color */
    color: white;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .book-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    }

    .filters {
        flex-direction: column;
        align-items: stretch;
    }

    .search-bar, .filter-select {
        width: 100%;
    }

    .stats-bar {
        flex-wrap: wrap;
        gap: 10px;
    }

    .stat-item {
        min-width: 120px;
    }
}
 </style>
</head>
<body>

    
  <div class="loader" id="loader">
    <div class="spinner"></div>
  </div>
  <header class="header">
    <a href="#" class="logo">
        <!-- <div class="logo-icon">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z" />
            </svg>
        </div> -->
        <span>KHCRF</span>
    </a>

    <div class="nav-container">
        <nav class="nav-links" id="navLinks">
            <a href="dashboard.html" class="nav-item active" data-index="0">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z" /> -->
                </svg>
                <span>Home</span>
                <div class="tooltip">Home</div>
            </a>
            
            <a href="message.html" class="nav-item" data-index="1">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4C22,2.89 21.1,2 20,2Z" /> -->
                </svg>
                <span>Messages</span>
                <div class="notification-badge">3</div>
                <div class="tooltip">Messages</div>
            </a>
            
            <a href="donationdashboard.html" class="nav-item" data-index="2">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M12.75,3.94C13.15,3.94 13.5,4.29 13.5,4.69C13.5,5.09 13.15,5.44 12.75,5.44H11.25V10.61L15.44,12.93L15.43,12.92C15.79,13.19 15.89,13.69 15.63,14.06C15.37,14.42 14.87,14.5 14.5,14.25L10.23,11.86C9.93,11.69 9.75,11.36 9.75,11V5.44H8.25C7.85,5.44 7.5,5.09 7.5,4.69C7.5,4.29 7.85,3.94 8.25,3.94H12.75M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2Z" /> -->
                </svg>
                <span>Donation</span>
                <div class="tooltip">Donation</div>
            </a>
            
            <a href="user.html" class="nav-item" data-index="3">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" /> -->
                </svg>
                <span>User</span>
                <div class="tooltip">User</div>
            </a>
            
            <a href="memberhipdashb.html" class="nav-item" data-index="4">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z" /> -->
                </svg>
                <span>Membership</span>
                <div class="tooltip">Membership</div>
            </a>
            
            <a href="badgedashboard.html" class="nav-item" data-index="5">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M17,3H7A2,2 0 0,0 5,5V21L12,18L19,21V5C19,3.89 18.1,3 17,3M17,18L12,15.82L7,18V5H17V18M16,10H8V12H16V10M16,6H8V8H16V6Z" /> -->
                </svg>
                <span>Badge Application</span>
                <div class="tooltip">Badge Application</div>
            </a>
            
            <a href="books.html" class="nav-item" data-index="6">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M19,2L14,6.5V17.5L19,13V2M6.5,5C4.55,5 2.45,5.4 1,6.5V21.16C1,21.41 1.25,21.66 1.5,21.66C1.6,21.66 1.65,21.59 1.75,21.59C3.1,20.94 5.05,20.5 6.5,20.5C8.45,20.5 10.55,20.9 12,22C13.35,21.15 15.8,20.5 17.5,20.5C19.15,20.5 20.85,20.81 22.25,21.56C22.35,21.61 22.4,21.59 22.5,21.59C22.75,21.59 23,21.34 23,21.09V6.5C22.4,6.05 21.75,5.75 21,5.5V19C19.9,18.65 18.7,18.5 17.5,18.5C15.8,18.5 13.35,19.15 12,20V6.5C10.55,5.4 8.45,5 6.5,5Z" /> -->
                </svg>
                <span>Manage Books</span>
                <div class="tooltip">Manage Books</div>
            </a>
            
           


            <a href="certificationdashboard.html" class="nav-item" data-index="8">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z" /> -->
                </svg>
                <span>Certification</span>
                <div class="tooltip">Certification</div>
            </a>
            <a href="collaboration.html" class="nav-item" data-index="8">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z" /> -->
                </svg>
                <span>Collaboration</span>
                <div class="tooltip">Collaboration</div>
            </a>
            <a href="Pre-OrderDashboard.html" class="nav-item" data-index="8">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <!-- <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z" /> -->
                </svg>
                <span>Books Pre orders</span>
                <div class="tooltip"></div>
            </a>
            
            <div class="active-bg"></div>
        </nav>
    </div>

    <!-- <div class="right-section" style="display:flex; align-items:center;">
        <div class="search-box">
            <input type="text" class="search-input" placeholder="Search...">
            <svg class="search-icon" viewBox="0 0 24 24">
                <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
            </svg>
        </div> -->

        <!-- <div class="theme-toggle">
            <svg class="theme-icon" viewBox="0 0 24 24">
                <path d="M12,18C11.11,18 10.26,17.8 9.5,17.45C11.56,16.5 13,14.42 13,12C13,9.58 11.56,7.5 9.5,6.55C10.26,6.2 11.11,6 12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18M20,8.69V4H15.31L12,0.69L8.69,4H4V8.69L0.69,12L4,15.31V20H8.69L12,23.31L15.31,20H20V15.31L23.31,12L20,8.69Z" />
            </svg>
        </div> -->

        <!-- <div class="user-profile">
            <div class="avatar">JD</div>
            <div class="user-info">
                <div class="user-name">John Doe</div>
                <div class="user-role">Administrator</div>
            </div>
        </div> -->

        <div class="menu-toggle" id="menuToggle">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
</header>

<h1 style="margin-top: 100px; text-align: center;">
    <i class="fas fa-book-open"></i> Book Management System
  </h1>
    

  <div class="container">
    <!-- Stats Bar -->
    <div class="stats-bar" id="statsBar">
      <div class="stat-item">
        <div class="stat-value" id="totalBooks">0</div>
        <div class="stat-label">Total Books</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="totalCategories">0</div>
        <div class="stat-label">Categories</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="avgPrice">₹0</div>
        <div class="stat-label">Avg. Price</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="totalValue">₹0</div>
        <div class="stat-label">Total Value</div>
      </div>
    </div>

    <!-- Upload Form -->
    <div class="form-container">
      <h2 class="form-title"><i class="fas fa-upload"></i> Upload New Book</h2>
      <form id="uploadBookForm">
        <div class="form-row">
          <label for="title"><i class="fas fa-heading"></i> Title</label>
          <input type="text" id="title" name="title" required placeholder="Enter book title">
        </div>
        
        <div class="form-row">
          <label for="author"><i class="fas fa-user"></i> Author</label>
          <input type="text" id="author" name="author" required placeholder="Enter author name">
        </div>
        
        <div class="form-row">
          <label for="category"><i class="fas fa-tags"></i> Category</label>
          <select id="category" name="category" required>
            <option value="">Select a category</option>
            <option value="best_practices">Best Practices</option>
            <option value="case_studies">Case Studies</option>
            <option value="research_papers">Research Papers</option>
            <option value="e_book">E-Book</option>
          </select>
        </div>
        
        <div class="form-row">
          <label for="price"><i class="fas fa-rupee-sign"></i> Price (INR)</label>
          <input type="number" id="price" name="price" step="0.01" min="0" required placeholder="Enter price in INR">
        </div>
        
        <div class="form-row">
          <label for="cover"><i class="fas fa-image"></i> Cover Image</label>
          <div class="file-input-container">
            <label class="file-input-button" for="cover">
              <i class="fas fa-cloud-upload-alt"></i> Choose Cover Image
            </label>
            <input type="file" id="cover" name="cover" accept="image/*" required class="file-input">
            <div class="file-name" id="coverFileName">No file chosen</div>
          </div>
          <div class="upload-preview" id="coverPreview">
            <img id="coverPreviewImage" src="#" alt="Cover Preview">
          </div>
        </div>
        
        <div class="form-row">
          <label for="pdf"><i class="fas fa-file-pdf"></i> PDF File</label>
          <div class="file-input-container">
            <label class="file-input-button" for="pdf">
              <i class="fas fa-cloud-upload-alt"></i> Choose PDF File
            </label>
            <input type="file" id="pdf" name="pdf" accept="application/pdf" required class="file-input">
            <div class="file-name" id="pdfFileName">No file chosen</div>
          </div>
        </div>
        
        <button type="submit" class="submit-button" id="uploadButton">
          <i class="fas fa-upload"></i> Upload Book
        </button>
      </form>
    </div>

    <!-- Search and Filters -->
    <div class="filters">
      <div class="search-bar">
        <i class="fas fa-search search-icon"></i>
        <input type="text" id="searchInput" placeholder="Search by title or author...">
      </div>
      
      <select id="categoryFilter" class="filter-select">
        <option value="">All Categories</option>
        <option value="best_practices">Best Practices</option>
        <option value="case_studies">Case Studies</option>
        <option value="research_papers">Research Papers</option>
        <option value="e_book">E-Book</option>
      </select>
      
      <select id="sortOption" class="filter-select">
        <option value="title_asc">Title (A-Z)</option>
        <option value="title_desc">Title (Z-A)</option>
        <option value="price_asc">Price (Low to High)</option>
        <option value="price_desc">Price (High to Low)</option>
        <option value="newest">Newest First</option>
      </select>
    </div>

    <!-- Books Display -->
    <h2 class="form-title"><i class="fas fa-book"></i> Available Books</h2>
    <div class="book-grid" id="bookGrid"></div>
    
    <!-- Empty State -->
    <div class="empty-state" id="emptyState" style="display: none;">
      <i class="fas fa-books"></i>
      <h3>No Books Found</h3>
      <p>Try adjusting your filters or upload a new book.</p>
    </div>
    
    <!-- Pagination -->
    <div class="pagination" id="pagination"></div>

    <!-- Edit Book Modal -->
    <div class="modal-overlay" id="editModal">
      <div class="modal-container">
        <button class="close-modal" id="closeEditModal"><i class="fas fa-times"></i></button>
        <h2 class="form-title"><i class="fas fa-edit"></i> Edit Book</h2>
        <form id="editBookForm">
          <input type="hidden" id="editBookId">
          
          <div class="form-row">
            <label for="editTitle"><i class="fas fa-heading"></i> Title</label>
            <input type="text" id="editTitle" name="title" required>
          </div>
          
          <div class="form-row">
            <label for="editAuthor"><i class="fas fa-user"></i> Author</label>
            <input type="text" id="editAuthor" name="author" required>
          </div>
          
          <div class="form-row">
            <label for="editCategory"><i class="fas fa-tags"></i> Category</label>
            <select id="editCategory" name="category" required>
              <option value="best_practices">Best Practices</option>
              <option value="case_studies">Case Studies</option>
              <option value="research_papers">Research Papers</option>
              <option value="e_book">E-Book</option>
            </select>
          </div>
          
          <div class="form-row">
            <label for="editPrice"><i class="fas fa-rupee-sign"></i> Price (INR)</label>
            <input type="number" id="editPrice" name="price" step="0.01" min="0" required>
          </div>
          
          <div class="form-row">
            <label><i class="fas fa-image"></i> Current Cover Image</label>
            <img id="currentCoverImage" src="#" alt="Current Cover" style="max-width: 100%; max-height: 150px; margin-bottom: 10px;">
          </div>
          
          <div class="form-row">
            <label for="editCover"><i class="fas fa-image"></i> New Cover Image (Optional)</label>
            <div class="file-input-container">
              <label class="file-input-button" for="editCover">
                <i class="fas fa-cloud-upload-alt"></i> Choose New Cover Image
              </label>
              <input type="file" id="editCover" name="cover" accept="image/*" class="file-input">
              <div class="file-name" id="editCoverFileName">No file chosen</div>
            </div>
            <div class="upload-preview" id="editCoverPreview">
              <img id="editCoverPreviewImage" src="#" alt="Cover Preview">
            </div>
          </div>
          
          <div class="form-row">
            <label for="editPdf"><i class="fas fa-file-pdf"></i> New PDF File (Optional)</label>
            <div class="file-input-container">
              <label class="file-input-button" for="editPdf">
                <i class="fas fa-cloud-upload-alt"></i> Choose New PDF File
              </label>
              <input type="file" id="editPdf" name="pdf" accept="application/pdf" class="file-input">
              <div class="file-name" id="editPdfFileName">No file chosen</div>
            </div>
          </div>
          
          <button type="submit" class="submit-button">
            <i class="fas fa-save"></i> Update Book
          </button>
        </form>
      </div>
    </div>

    <!-- Book Details Modal -->
    <div class="modal-overlay" id="detailsModal">
      <div class="modal-container">
        <button class="close-modal" id="closeDetailsModal"><i class="fas fa-times"></i></button>
        <div class="book-details" id="bookDetails"></div>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="deleteModal">
      <div class="modal-container">
        <div class="confirm-dialog">
          <h3><i class="fas fa-exclamation-triangle" style="color: var(--error-color);"></i> Confirm Deletion</h3>
          <p>Are you sure you want to delete "<span id="deleteBookTitle"></span>"? This action cannot be undone.</p>
          <div class="confirm-buttons">
            <button class="confirm-button confirm-no" id="cancelDelete">Cancel</button>
            <button class="confirm-button confirm-yes" id="confirmDelete">Delete</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastify-js/1.12.0/toastify.min.js"></script>
  <script src="config.js"></script>
  <script>
    // Configuration
    const ITEMS_PER_PAGE = 6;
    const UPLOADS_PATH = '/uploads'; // Define the uploads directory path
  
    // State variables
    let allBooks = [];
    let filteredBooks = [];
    let currentPage = 1;
    let bookToDelete = null;
  
    // DOM Elements
    const loader = document.getElementById('loader');
    const bookGrid = document.getElementById('bookGrid');
    const emptyState = document.getElementById('emptyState');
    const searchInput = document.getElementById('searchInput');
    const categoryFilter = document.getElementById('categoryFilter');
    const sortOption = document.getElementById('sortOption');
    const pagination = document.getElementById('pagination');
    const editModal = document.getElementById('editModal');
    const deleteModal = document.getElementById('deleteModal');
    const detailsModal = document.getElementById('detailsModal');
    const statsBar = document.getElementById('statsBar');
  
    // Helper functions for UI interaction
    const showLoader = () => {
      loader.style.display = 'flex';
    };
  
    const hideLoader = () => {
      loader.style.display = 'none';
    };
  
    const showToast = (message, type = 'success') => {
      Toastify({
        text: message,
        duration: 3000,
        gravity: 'top',
        position: 'right',
        backgroundColor: type === 'success' ? '#2ecc71' : '#e74c3c',
        stopOnFocus: true,
      }).showToast();
    };
  
    const formatPrice = (price) => {
      const num = parseFloat(price);
      return isNaN(num) ? '₹0.00' : `₹${num.toFixed(2)}`;
    };
  
    const getCategoryBadge = (category) => {
      const categories = {
        best_practices: { label: 'Best Practices', class: 'badge-best-practices' },
        case_studies: { label: 'Case Studies', class: 'badge-case-studies' },
        research_papers: { label: 'Research Papers', class: 'badge-research-papers' },
        e_book: { label: 'E-Book', class: 'badge-e-book' }
      };
      const categoryInfo = categories[category] || { label: category, class: '' };
      return `<span class="badge ${categoryInfo.class}">${categoryInfo.label}</span>`;
    };
  
    const formatDateString = (dateString) => {
      if (!dateString) return 'N/A';
      const date = new Date(dateString);
      if (isNaN(date.getTime())) return 'N/A';
      return date.toLocaleDateString('en-IN', {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
    };
  
    // API Communication Functions
    const apiRequest = async (url, method = 'GET', data = null, isFormData = false) => {
      try {
        showLoader();
  
        // Get the JWT token from localStorage
        const authToken = localStorage.getItem('authToken');
        if (!authToken) {
          throw new Error('Not authorized, no token');
        }
  
        const options = {
          method,
          headers: {
            'Authorization': `Bearer ${authToken}`, // Add the Authorization header
            ...(!isFormData ? { 'Content-Type': 'application/json' } : {}), // Add Content-Type for non-form-data requests
          },
          body: data ? (isFormData ? data : JSON.stringify(data)) : null,
        };
  
        const response = await fetch(`${API_BASE}${url}`, options);
  
        if (!response.ok) {
          const errorText = await response.text();
          throw new Error(errorText || `Request failed with status ${response.status}`);
        }
  
        if (method === 'DELETE') return { success: true };
        return await response.json();
      } catch (error) {
        console.error('API Request Error:', error);
        throw error;
      } finally {
        hideLoader();
      }
    };
  
    const fetchBooks = async () => {
      try {
        const books = await apiRequest('/api/ebook');
        allBooks = books;
        updateStats(books);
        return books;
      } catch (error) {
        showToast(`Failed to fetch books: ${error.message}`, 'error');
        return [];
      }
    };
  
    const uploadBook = async (formData) => {
      try {
        const result = await apiRequest('/api/ebook', 'POST', formData, true);
        showToast('Book uploaded successfully!');
        return result;
      } catch (error) {
        showToast(`Failed to upload book: ${error.message}`, 'error');
        throw error;
      }
    };
  
    const updateBook = async (id, formData) => {
      try {
        const result = await apiRequest(`/api/ebook/${id}`, 'PUT', formData, true);
        showToast('Book updated successfully!');
        return result;
      } catch (error) {
        showToast(`Failed to update book: ${error.message}`, 'error');
        throw error;
      }
    };
  
    const deleteBook = async (id) => {
      try {
        await apiRequest(`/api/ebook/${id}`, 'DELETE');
        showToast('Book deleted successfully!');
        return true;
      } catch (error) {
        showToast(`Failed to delete book: ${error.message}`, 'error');
        return false;
      }
    };
  
    const getBookDetails = async (id) => {
      try {
        return await apiRequest(`/api/ebook/details/${id}`);
      } catch (error) {
        showToast(`Failed to fetch book details: ${error.message}`, 'error');
        throw error;
      }
    };
  
    // UI Update Functions
    const updateStats = (books) => {
      if (!books || books.length === 0) {
        document.getElementById('totalBooks').textContent = '0';
        document.getElementById('totalCategories').textContent = '0';
        document.getElementById('avgPrice').textContent = '₹0.00';
        document.getElementById('totalValue').textContent = '₹0.00';
        return;
      }
      const totalBooks = books.length;
      const categories = new Set();
      books.forEach(book => categories.add(book.category));
      const totalCategories = categories.size;
      let totalValue = 0;
      books.forEach(book => {
        const price = parseFloat(book.price);
        if (!isNaN(price)) totalValue += price;
      });
      const avgPrice = totalValue / totalBooks;
      document.getElementById('totalBooks').textContent = totalBooks;
      document.getElementById('totalCategories').textContent = totalCategories;
      document.getElementById('avgPrice').textContent = formatPrice(avgPrice);
      document.getElementById('totalValue').textContent = formatPrice(totalValue);
    };
  
    const renderBooks = () => {
      const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
      const endIndex = startIndex + ITEMS_PER_PAGE;
      const displayedBooks = filteredBooks.slice(startIndex, endIndex);
      bookGrid.innerHTML = '';
      if (displayedBooks.length === 0) {
        emptyState.style.display = 'block';
        pagination.style.display = 'none';
        return;
      }
      emptyState.style.display = 'none';
      displayedBooks.forEach(book => {
        const bookCard = document.createElement('div');
        bookCard.className = 'book-card';
        const price = parseFloat(book.price);
        if (isNaN(price)) return;
        const pdfURL = `${API_BASE}/${book.pdfFile}`; // Correct PDF URL
        bookCard.innerHTML = `
          <img src="${API_BASE}/${book.coverImage}" alt="${book.title}" onerror="this.src='/api/placeholder/300/200'">
          <div class="book-info">
            <div class="book-title">${book.title}</div>
            <div class="book-author"><i class="fas fa-user"></i> ${book.author}</div>
            <div class="book-category"><i class="fas fa-tags"></i> ${getCategoryBadge(book.category)}</div>
            <div class="book-price"><i class="fas fa-rupee-sign"></i> ${formatPrice(price)}</div>
            <div class="book-actions">
              <a href="${pdfURL}" target="_blank" class="action-button view">
                <i class="fas fa-eye"></i> View PDF
              </a>
              <button class="action-button" data-id="${book.id}" data-action="edit">
                <i class="fas fa-edit"></i> Edit
              </button>
              <button class="action-button delete" data-id="${book.id}" data-action="delete">
                <i class="fas fa-trash"></i> Delete
              </button>
            </div>
          </div>
        `;
        bookGrid.appendChild(bookCard);
      });
      renderPagination();
    };
  
    const renderPagination = () => {
      if (filteredBooks.length <= ITEMS_PER_PAGE) {
        pagination.style.display = 'none';
        return;
      }
  
      pagination.style.display = 'flex';
      pagination.innerHTML = '';
  
      const totalPages = Math.ceil(filteredBooks.length / ITEMS_PER_PAGE);
  
      // Previous button
      const prevButton = document.createElement('button');
      prevButton.className = 'page-button';
      prevButton.innerHTML = '<i class="fas fa-chevron-left"></i>';
      prevButton.disabled = currentPage === 1;
      prevButton.addEventListener('click', () => {
        if (currentPage > 1) {
          currentPage--;
          renderBooks();
        }
      });
      pagination.appendChild(prevButton);
  
      // Page buttons
      const startPage = Math.max(1, currentPage - 2);
      const endPage = Math.min(totalPages, startPage + 4);
  
      for (let i = startPage; i <= endPage; i++) {
        const pageButton = document.createElement('button');
        pageButton.className = `page-button ${i === currentPage ? 'active' : ''}`;
        pageButton.textContent = i;
        pageButton.addEventListener('click', () => {
          currentPage = i;
          renderBooks();
        });
        pagination.appendChild(pageButton);
      }
  
      // Next button
      const nextButton = document.createElement('button');
      nextButton.className = 'page-button';
      nextButton.innerHTML = '<i class="fas fa-chevron-right"></i>';
      nextButton.disabled = currentPage === totalPages;
      nextButton.addEventListener('click', () => {
        if (currentPage < totalPages) {
          currentPage++;
          renderBooks();
        }
      });
      pagination.appendChild(nextButton);
    };
  
    const filterBooks = () => {
      const searchTerm = searchInput.value.toLowerCase();
      const category = categoryFilter.value;
      const sort = sortOption.value;
  
      // Apply filters
      filteredBooks = allBooks.filter(book => {
        const titleMatch = book.title && book.title.toLowerCase().includes(searchTerm);
        const authorMatch = book.author && book.author.toLowerCase().includes(searchTerm);
        const categoryMatch = !category || book.category === category;
  
        return (titleMatch || authorMatch) && categoryMatch;
      });
  
      // Apply sorting
      filteredBooks.sort((a, b) => {
        switch (sort) {
          case 'title_asc':
            return a.title.localeCompare(b.title);
          case 'title_desc':
            return b.title.localeCompare(a.title);
          case 'price_asc':
            return parseFloat(a.price) - parseFloat(b.price);
          case 'price_desc':
            return parseFloat(b.price) - parseFloat(a.price);
          case 'newest':
            return new Date(b.createdAt || 0) - new Date(a.createdAt || 0);
          default:
            return 0;
        }
      });
  
      // Reset to first page when filters change
      currentPage = 1;
      renderBooks();
    };
  
    const showBookDetails = async (id) => {
      try {
        const book = await getBookDetails(id);
  
        const detailsHTML = `
          <img src="${API_BASE}/${book.coverImage}" alt="${book.title}" class="book-details-image" 
               onerror="this.src='/api/placeholder/400/300'">
          <div class="book-details-info">
            <h2>${book.title}</h2>
  
            <div class="book-detail-row">
              <i class="fas fa-user"></i>
              <span><strong>Author:</strong> ${book.author}</span>
            </div>
  
            <div class="book-detail-row">
              <i class="fas fa-tags"></i>
              <span><strong>Category:</strong> ${getCategoryBadge(book.category)}</span>
            </div>
  
            <div class="book-detail-row">
              <i class="fas fa-rupee-sign"></i>
              <span><strong>Price:</strong> ${formatPrice(book.price)}</span>
            </div>
  
            <div class="book-detail-row">
              <i class="fas fa-calendar-alt"></i>
              <span><strong>Added:</strong> ${formatDateString(book.createdAt)}</span>
            </div>
  
            <div class="book-detail-row">
              <i class="fas fa-clock"></i>
              <span><strong>Last Updated:</strong> ${formatDateString(book.updatedAt)}</span>
            </div>
  
            <div class="book-details-actions">
              <a href="${API_BASE}/${book.pdfFile}" target="_blank" class="action-button view">
                <i class="fas fa-file-pdf"></i> View PDF
              </a>
              <button class="action-button" onclick="openEditModal('${book.id}')">
                <i class="fas fa-edit"></i> Edit
              </button>
              <button class="action-button delete" onclick="openDeleteModal('${book.id}', '${book.title}')">
                <i class="fas fa-trash"></i> Delete
              </button>
            </div>
          </div>
        `;
  
        document.getElementById('bookDetails').innerHTML = detailsHTML;
        detailsModal.style.display = 'flex';
      } catch (error) {
        console.error('Error showing book details:', error);
      }
    };
  
    // Modal Functions
    const openEditModal = async (id) => {
      try {
        const book = await getBookDetails(id);
  
        document.getElementById('editBookId').value = book.id;
        document.getElementById('editTitle').value = book.title;
        document.getElementById('editAuthor').value = book.author;
        document.getElementById('editCategory').value = book.category;
        document.getElementById('editPrice').value = book.price;
        document.getElementById('currentCoverImage').src = `${API_BASE}/${book.coverImage}`;
        document.getElementById('editCoverFileName').textContent = 'No new file chosen';
        document.getElementById('editPdfFileName').textContent = 'No new file chosen';
  
        document.getElementById('editCoverPreview').style.display = 'none';
  
        editModal.style.display = 'flex';
      } catch (error) {
        showToast(`Error loading book for editing: ${error.message}`, 'error');
      }
    };
  
    const openDeleteModal = (id, title) => {
      bookToDelete = id;
      document.getElementById('deleteBookTitle').textContent = title;
      deleteModal.style.display = 'flex';
    };
  
    const refreshBookList = async () => {
      await fetchBooks();
      filterBooks();
    };
  
    // File Preview Functions
    const setupFilePreview = (fileInput, fileNameElement, previewContainer, previewImage) => {
      fileInput.addEventListener('change', function() {
        if (this.files && this.files[0]) {
          const fileName = this.files[0].name;
          fileNameElement.textContent = fileName;
  
          if (this.files[0].type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = function(e) {
              previewImage.src = e.target.result;
              previewContainer.style.display = 'block';
            };
            reader.readAsDataURL(this.files[0]);
          }
        } else {
          fileNameElement.textContent = 'No file chosen';
          previewContainer.style.display = 'none';
        }
      });
    };
  
    // Event Listeners
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        await refreshBookList();
  
        // Setup file input previews
        setupFilePreview(
          document.getElementById('cover'),
          document.getElementById('coverFileName'),
          document.getElementById('coverPreview'),
          document.getElementById('coverPreviewImage')
        );
  
        setupFilePreview(
          document.getElementById('editCover'),
          document.getElementById('editCoverFileName'),
          document.getElementById('editCoverPreview'),
          document.getElementById('editCoverPreviewImage')
        );
  
        // File name updates
        document.getElementById('pdf').addEventListener('change', function() {
          if (this.files && this.files[0]) {
            document.getElementById('pdfFileName').textContent = this.files[0].name;
          } else {
            document.getElementById('pdfFileName').textContent = 'No file chosen';
          }
        });
  
        document.getElementById('editPdf').addEventListener('change', function() {
          if (this.files && this.files[0]) {
            document.getElementById('editPdfFileName').textContent = this.files[0].name;
          } else {
            document.getElementById('editPdfFileName').textContent = 'No file chosen';
          }
        });
      } catch (error) {
        console.error('Initialization error:', error);
        showToast('Failed to initialize the application. Please refresh the page.', 'error');
      }
    });
  
    // Form submissions
    document.getElementById('uploadBookForm').addEventListener('submit', async function(e) {
      e.preventDefault();
  
      try {
        const formData = new FormData(this);
        await uploadBook(formData);
        this.reset();
  
        // Reset file input previews
        document.getElementById('coverFileName').textContent = 'No file chosen';
        document.getElementById('pdfFileName').textContent = 'No file chosen';
        document.getElementById('coverPreview').style.display = 'none';
  
        await refreshBookList();
      } catch (error) {
        console.error('Error submitting upload form:', error);
      }
    });
  
    document.getElementById('editBookForm').addEventListener('submit', async function(e) {
      e.preventDefault();
  
      try {
        const bookId = document.getElementById('editBookId').value;
        const formData = new FormData(this);
  
        // Only include file inputs if they have files selected
        if (!document.getElementById('editCover').files.length) {
          formData.delete('cover');
        }
  
        if (!document.getElementById('editPdf').files.length) {
          formData.delete('pdf');
        }
  
        await updateBook(bookId, formData);
        editModal.style.display = 'none';
        await refreshBookList();
      } catch (error) {
        console.error('Error submitting edit form:', error);
      }
    });
  
    // Filter change events
    searchInput.addEventListener('input', filterBooks);
    categoryFilter.addEventListener('change', filterBooks);
    sortOption.addEventListener('change', filterBooks);
  
    // Modal close buttons
    document.getElementById('closeEditModal').addEventListener('click', () => {
      editModal.style.display = 'none';
    });
  
    document.getElementById('closeDetailsModal').addEventListener('click', () => {
      detailsModal.style.display = 'none';
    });
  
    // Delete confirmation
    document.getElementById('cancelDelete').addEventListener('click', () => {
      deleteModal.style.display = 'none';
      bookToDelete = null;
    });
  
    document.getElementById('confirmDelete').addEventListener('click', async () => {
      if (bookToDelete) {
        const success = await deleteBook(bookToDelete);
        if (success) {
          await refreshBookList();
        }
        bookToDelete = null;
      }
      deleteModal.style.display = 'none';
    });
  
    // Book grid action buttons
    bookGrid.addEventListener('click', async (e) => {
      const target = e.target.closest('.action-button');
      if (!target) return;
  
      const bookId = target.dataset.id;
      if (!bookId) return;
  
      const action = target.dataset.action;
  
      if (target.classList.contains('view') || !action) {
        await showBookDetails(bookId);
      } else if (action === 'edit') {
        await openEditModal(bookId);
      } else if (action === 'delete') {
        const bookCard = target.closest('.book-card');
        const bookTitle = bookCard.querySelector('.book-title').textContent;
        openDeleteModal(bookId, bookTitle);
      }
    });
  
    // Close modals when clicking outside
    window.addEventListener('click', (e) => {
      if (e.target === editModal) {
        editModal.style.display = 'none';
      }
      if (e.target === deleteModal) {
        deleteModal.style.display = 'none';
      }
      if (e.target === detailsModal) {
        detailsModal.style.display = 'none';
      }
    });
  
    // Handle network errors globally
    window.addEventListener('online', () => {
      showToast('You are back online! Refreshing data...', 'success');
      refreshBookList();
    });
  
    window.addEventListener('offline', () => {
      showToast('You are offline. Some features may be unavailable.', 'error');
    });
  
    // Make functions available globally for inline event handlers
    window.openEditModal = openEditModal;
    window.openDeleteModal = openDeleteModal;
  </script>

<script>
    // Get references to the menu toggle and nav links
    const menuToggle = document.getElementById('menuToggle');
    const navLinks = document.getElementById('navLinks');

    // Add click event listener to the menu toggle
    menuToggle.addEventListener('click', () => {
        // Toggle the 'active' class on the nav links
        navLinks.classList.toggle('active');
        // Toggle the 'active' class on the menu toggle for the animation
        menuToggle.classList.toggle('active');
    });
</script>
</body>
</html>