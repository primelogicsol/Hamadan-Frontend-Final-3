<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Donation Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    

<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    
    :root {
        --primary: #6d28d9;
        --primary-light: #8b5cf6;
        --primary-dark: #5b21b6;
        --secondary: #10b981;
        --dark-bg: #0f172a;
        --darker-bg: #0a0f1c;
        --card-bg: #1e293b;
        --text-color: #f1f5f9;
        --text-muted: #94a3b8;
        --border-color: rgba(255, 255, 255, 0.06);
        --transition-speed: 0.3s;
        --glow-color: rgba(109, 40, 217, 0.5);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;
    }

    body {
        background-color: var(--darker-bg);
        color: var(--text-color);
        overflow-x: hidden;
        min-height: 100vh;
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 2rem;
        background-color: var(--dark-bg);
        height: 70px;
        position: fixed;
        width: 100%;
        top: 0;
        z-index: 1000;
        box-shadow: 0 3px 20px rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(10px);
        transition: all var(--transition-speed) ease;
        border-bottom: 1px solid var(--border-color);
    }

    .header:hover {
        box-shadow: 0 5px 25px rgba(109, 40, 217, 0.3);
    }

    /* Logo */
    .logo {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 700;
        font-size: 1.5rem;
        color: var(--primary-light);
        text-decoration: none;
        position: relative;
        z-index: 2;
    }

    .logo-icon {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 40px;
        width: 40px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        border-radius: 12px;
        box-shadow: 0 0 15px rgba(109, 40, 217, 0.5);
        position: relative;
        overflow: hidden;
        transition: all 0.5s ease;
    }

    .logo-icon::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: conic-gradient(from 0deg, transparent 0%, transparent 30%, rgba(255, 255, 255, 0.3) 40%, transparent 50%);
        animation: rotate 4s linear infinite;
    }

    @keyframes rotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .logo-icon svg {
        height: 22px;
        width: 22px;
        fill: white;
        z-index: 2;
    }

    .logo span {
        background: linear-gradient(90deg, var(--primary-light), #d8b4fe);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-weight: 700;
    }

    /* Navigation */
    .nav-container {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .nav-links {
        display: flex;
        gap: 0.25rem;
        position: relative;
    }

    .nav-item {
        position: relative;
        padding: 0.75rem 1rem;
        color: var(--text-color);
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        border-radius: 12px;
        transition: all var(--transition-speed) cubic-bezier(0.34, 1.56, 0.64, 1);
        font-weight: 500;
        font-size: 0.95rem;
        z-index: 2;
        overflow: hidden;
    }

    .nav-item::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, rgba(109, 40, 217, 0.1), rgba(139, 92, 246, 0.1));
        opacity: 0;
        transition: opacity 0.4s ease;
        z-index: -1;
        border-radius: 12px;
    }

    .nav-item:hover::before, .nav-item.active::before {
        opacity: 1;
    }

    .nav-item.active {
        color: var(--primary-light);
        font-weight: 600;
    }

    .nav-item:hover {
        transform: translateY(-3px);
        color: var(--primary-light);
    }

    .nav-item .nav-icon {
        width: 22px;
        height: 22px;
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        position: relative;
    }

    .nav-item:hover .nav-icon, .nav-item.active .nav-icon {
        fill: var(--primary-light);
        transform: scale(1.1);
    }

    /* Active indicator */
    .active-bg {
        position: absolute;
        background: linear-gradient(to right, rgba(109, 40, 217, 0.2), rgba(139, 92, 246, 0.1));
        border-radius: 12px;
        z-index: 1;
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        box-shadow: 0 5px 15px rgba(109, 40, 217, 0.2);
    }

    /* Notification badge */
    .notification-badge {
        position: absolute;
        top: 0;
        right: 0;
        background: var(--secondary);
        color: white;
        border-radius: 50%;
        width: 18px;
        height: 18px;
        font-size: 0.65rem;
        display: flex;
        justify-content: center;
        align-items: center;
        transform: translate(25%, -25%);
        box-shadow: 0 2px 5px rgba(16, 185, 129, 0.5);
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% { transform: translate(25%, -25%) scale(1); }
        50% { transform: translate(25%, -25%) scale(1.1); }
        100% { transform: translate(25%, -25%) scale(1); }
    }

    /* Search box */
    .search-box {
        position: relative;
        margin-right: 1rem;
    }

    .search-input {
        background-color: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 0.5rem 1rem 0.5rem 2.5rem;
        color: var(--text-color);
        font-size: 0.9rem;
        transition: all 0.3s ease;
        width: 200px;
    }

    .search-input:focus {
        outline: none;
        background-color: rgba(255, 255, 255, 0.1);
        border-color: var(--primary-light);
        box-shadow: 0 0 0 2px rgba(109, 40, 217, 0.2);
        width: 250px;
    }

    .search-icon {
        position: absolute;
        left: 10px;
        top: 50%;
        transform: translateY(-50%);
        fill: var(--text-muted);
        width: 16px;
        height: 16px;
        pointer-events: none;
        transition: all 0.3s ease;
    }

    .search-input:focus + .search-icon {
        fill: var(--primary-light);
    }

    /* User profile */
    .user-profile {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        cursor: pointer;
        padding: 0.5rem;
        border-radius: 12px;
        transition: all 0.3s ease;
        border: 1px solid transparent;
    }

    .user-profile:hover {
        background-color: rgba(255, 255, 255, 0.05);
        border-color: var(--border-color);
    }

    .avatar {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: linear-gradient(135deg, #3b82f6, #8b5cf6);
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-weight: 600;
        font-size: 1.2rem;
        box-shadow: 0 3px 10px rgba(59, 130, 246, 0.3);
        position: relative;
        overflow: hidden;
    }

    .avatar::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.3), transparent);
        animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
    }

    .user-info {
        display: flex;
        flex-direction: column;
    }

    .user-name {
        font-weight: 600;
        font-size: 0.95rem;
    }

    .user-role {
        font-size: 0.8rem;
        color: var(--text-muted);
    }

    /* Mobile menu */
    .menu-toggle {
        display: none;
        flex-direction: column;
        justify-content: space-between;
        width: 30px;
        height: 21px;
        cursor: pointer;
        z-index: 10;
    }

    .menu-toggle span {
        display: block;
        height: 3px;
        width: 100%;
        border-radius: 3px;
        background-color: var(--text-color);
        transition: all 0.3s cubic-bezier(0.68, -0.6, 0.32, 1.6);
    }

    .menu-toggle.active span:nth-of-type(1) {
        transform: rotate(45deg) translate(5px, 6px);
        background-color: var(--primary-light);
    }

    .menu-toggle.active span:nth-of-type(2) {
        opacity: 0;
    }

    .menu-toggle.active span:nth-of-type(3) {
        transform: rotate(-45deg) translate(5px, -6px);
        background-color: var(--primary-light);
    }

    /* Content placeholder */
    .content {
        margin-top: 100px;
        padding: 2rem;
        text-align: center;
    }

    /* Tooltip */
    .tooltip {
        position: absolute;
        background-color: var(--dark-bg);
        color: white;
        padding: 0.5rem 0.75rem;
        border-radius: 6px;
        font-size: 0.8rem;
        bottom: -40px;
        opacity: 0;
        pointer-events: none;
        transition: all 0.3s ease;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        border: 1px solid var(--border-color);
        white-space: nowrap;
    }

    .tooltip::before {
        content: '';
        position: absolute;
        top: -5px;
        left: 50%;
        transform: translateX(-50%);
        border-width: 0 5px 5px 5px;
        border-style: solid;
        border-color: transparent transparent var(--dark-bg) transparent;
    }

    .nav-item:hover .tooltip {
        opacity: 1;
        bottom: -35px;
    }

    /* Theme toggle */
    .theme-toggle {
        margin-left: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 10px;
        background-color: rgba(255, 255, 255, 0.05);
        cursor: pointer;
        transition: all 0.3s ease;
        border: 1px solid var(--border-color);
    }

    .theme-toggle:hover {
        background-color: rgba(255, 255, 255, 0.1);
        transform: rotate(15deg);
    }

    .theme-icon {
        width: 20px;
        height: 20px;
        fill: var(--text-muted);
        transition: all 0.3s ease;
    }

    .theme-toggle:hover .theme-icon {
        fill: var(--primary-light);
    }

    /* Responsive design */
    @media (max-width: 1200px) {
        .search-box {
            display: none;
        }
        
        .nav-item span {
            display: none;
        }
        
        .nav-item {
            padding: 0.75rem;
        }
        
        .tooltip {
            display: none;
        }
    }

    @media (max-width: 992px) {
        .user-info {
            display: none;
        }
    }

    @media (max-width: 768px) {
        .header {
            padding: 0 1rem;
        }
        
        .nav-container {
            position: static;
        }
        
        .nav-links {
            position: fixed;
            flex-direction: column;
            top: 70px;
            left: 0;
            width: 100%;
            background-color: var(--darker-bg);
            transform: translateY(-150%);
            transition: transform 0.5s cubic-bezier(0.68, -0.6, 0.32, 1.6);
            z-index: 9;
            padding: 1rem 0;
            gap: 0.5rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid var(--border-color);
        }
        
        .nav-links.active {
            transform: translateY(0);
        }
        
        .nav-item {
            width: 90%;
            margin: 0 auto;
            padding: 1rem;
            border-radius: 12px;
        }
        
        .nav-item span {
            display: inline;
        }
        
        .active-bg {
            display: none;
        }
        
        .menu-toggle {
            display: flex;
        }
        
        .theme-toggle, .user-profile {
            margin-left: auto;
        }
    }

    /* Entrance animations */
    @keyframes slideFromTop {
        0% {
            transform: translateY(-50px);
            opacity: 0;
        }
        100% {
            transform: translateY(0);
            opacity: 1;
        }
    }

    @keyframes slideFromRight {
        0% {
            transform: translateX(50px);
            opacity: 0;
        }
        100% {
            transform: translateX(0);
            opacity: 1;
        }
    }

    @keyframes slideFromLeft {
        0% {
            transform: translateX(-50px);
            opacity: 0;
        }
        100% {
            transform: translateX(0);
            opacity: 1;
        }
    }

    @keyframes fadeIn {
        0% {
            opacity: 0;
        }
        100% {
            opacity: 1;
        }
    }

    @keyframes popIn {
        0% {
            transform: scale(0.8);
            opacity: 0;
        }
        70% {
            transform: scale(1.1);
        }
        100% {
            transform: scale(1);
            opacity: 1;
        }
    }

    .nav-item {
        animation: slideFromTop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
    }

    .nav-item:nth-child(1) { animation-delay: 0.1s; }
    .nav-item:nth-child(2) { animation-delay: 0.15s; }
    .nav-item:nth-child(3) { animation-delay: 0.2s; }
    .nav-item:nth-child(4) { animation-delay: 0.25s; }
    .nav-item:nth-child(5) { animation-delay: 0.3s; }
    .nav-item:nth-child(6) { animation-delay: 0.35s; }
    .nav-item:nth-child(7) { animation-delay: 0.4s; }
    .nav-item:nth-child(8) { animation-delay: 0.45s; }

    .logo {
        animation: slideFromLeft 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
        animation-delay: 0.1s;
    }

    .search-box {
        animation: fadeIn 0.5s ease backwards;
        animation-delay: 0.3s;
    }

    .user-profile {
        animation: slideFromRight 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
        animation-delay: 0.2s;
    }

    .theme-toggle {
        animation: popIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
        animation-delay: 0.4s;
    }

    /* Icon animations */
    .nav-item:hover .nav-icon {
        animation: rubberBand 0.8s;
    }

    @keyframes rubberBand {
        0% { transform: scale(1); }
        30% { transform: scale(1.25, 0.75); }
        40% { transform: scale(0.75, 1.25); }
        50% { transform: scale(1.15, 0.85); }
        65% { transform: scale(0.95, 1.05); }
        75% { transform: scale(1.05, 0.95); }
        100% { transform: scale(1); }
    }

    /* Glow effect */
    .nav-item.active::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 30px;
        height: 10px;
        background: radial-gradient(ellipse at center, var(--glow-color) 0%, transparent 70%);
        animation: glow 2s infinite;
    }

    @keyframes glow {
        0% { opacity: 0.5; }
        50% { opacity: 1; }
        100% { opacity: 0.5; }
    }
</style>
<style>
    /* Base styles and resets */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        background-color: #111827;
        color: #e5e7eb;
        line-height: 1.5;
        min-height: 100vh;
    }

    /* Gradient background */
    .gradient-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #111827 0%, #1f2937 100%);
        z-index: -1;
    }

    /* Dashboard container */
    .dashboard {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
    }

    /* Dashboard header */
    .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
    }

    .dashboard-header h1 {
        font-size: 2rem;
        font-weight: 600;
        color: #f3f4f6;
    }

    /* Stats container */
    .stats-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    /* Stat cards */
    .stat-card {
        background-color: #1f2937;
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .stat-card h3 {
        color: #9ca3af;
        font-size: 0.875rem;
        font-weight: 500;
        margin-bottom: 0.5rem;
    }

    .stat-card p {
        font-size: 1.875rem;
        font-weight: 600;
        color: #f3f4f6;
        margin-bottom: 0.5rem;
    }

    .trend {
        font-size: 0.875rem;
        color: #34d399;
    }

    /* Charts container */
    .charts-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .chart-card {
        background-color: #1f2937;
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    /* Data table */
    .data-table {
        background-color: #1f2937;
        border-radius: 0.75rem;
        overflow: auto;
        margin-top: 2rem;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 1rem;
        text-align: left;
        border-bottom: 1px solid #374151;
    }

    th {
        background-color: #374151;
        color: #f3f4f6;
        font-weight: 500;
    }

    td {
        color: #d1d5db;
    }

    tbody tr:hover {
        background-color: #374151;
    }

    /* Buttons */
    .button {
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        outline: none;
    }

    button {
        background-color: #3b82f6;
        color: white;
    }

    button:hover {
        background-color: #2563eb;
    }

    .approve {
        background-color: #059669;
        color: white;
        margin-right: 0.5rem;
    }

    .approve:hover {
        background-color: #047857;
    }

    .reject {
        background-color: #dc2626;
        color: white;
    }

    .reject:hover {
        background-color: #b91c1c;
    }

    /* Loader */
    .loader {
        display: none;
        border: 3px solid #f3f3f3;
        border-radius: 50%;
        border-top: 3px solid #3b82f6;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 2rem auto;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Error message */
    .error {
        display: none;
        color: #ef4444;
        text-align: center;
        padding: 1rem;
        margin: 1rem 0;
        background-color: #1f2937;
        border-radius: 0.375rem;
        border: 1px solid #dc2626;
    }

    /* Responsive design */
    @media (max-width: 768px) {
        .dashboard {
            padding: 1rem;
        }

        .charts-container {
            grid-template-columns: 1fr;
        }

        .data-table {
            overflow-x: auto;
        }

        .dashboard-header {
            flex-direction: column;
            gap: 1rem;
            text-align: center;
        }
    }

    /* Filters */
    .filters {
        margin: 20px 0;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .filters label {
        font-size: 14px;
        color: #9ca3af;
    }

    .filters select {
        padding: 8px 12px;
        border-radius: 6px;
        border: 1px solid #374151;
        background-color: #1f2937;
        color: #e5e7eb;
        font-size: 14px;
        outline: none;
        cursor: pointer;
        transition: border-color 0.2s ease;
    }

    .filters select:hover {
        border-color: #4b5563;
    }

    .filters select:focus {
        border-color: #3b82f6;
    }

    /* Pagination */
    .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
        margin: 20px 0;
    }

    .pagination button {
        padding: 8px 16px;
        border-radius: 6px;
        border: none;
        background-color: #3b82f6;
        color: white;
        font-size: 14px;
        cursor: pointer;
        transition: background-color 0.2s ease;
    }

    .pagination button:hover {
        background-color: #2563eb;
    }

    .pagination button:disabled {
        background-color: #374151;
        color: #6b7280;
        cursor: not-allowed;
    }

    .pagination span {
        font-size: 14px;
        color: #9ca3af;
    }
</style>
    
</head>
<body>
    <header class="header">
        <a href="#" class="logo">
            <span>KHCRF</span>
        </a>

        <div class="nav-container">
            <nav class="nav-links" id="navLinks">
                <a href="dashboard.html" class="nav-item active" data-index="0">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>Home</span>
                    <div class="tooltip">Home</div>
                </a>
                
                <a href="message.html" class="nav-item" data-index="1">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>Messages</span>
                    <div class="notification-badge">3</div>
                    <div class="tooltip">Messages</div>
                </a>
                
                <a href="donationdashboard.html" class="nav-item" data-index="2">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>Donation</span>
                    <div class="tooltip">Donation</div>
                </a>
                
                <a href="user.html" class="nav-item" data-index="3">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>User</span>
                    <div class="tooltip">User</div>
                </a>
                
                <a href="memberhipdashb.html" class="nav-item" data-index="4">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>Membership</span>
                    <div class="tooltip">Membership</div>
                </a>
                
                <a href="badgedashboard.html" class="nav-item" data-index="5">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>Badge Application</span>
                    <div class="tooltip">Badge Application</div>
                </a>
                
                <a href="books.html" class="nav-item" data-index="6">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>Manage Books</span>
                    <div class="tooltip">Manage Books</div>
                </a>
                
               

                <a href="certificationdashboard.html" class="nav-item" data-index="8">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>Certification</span>
                    <div class="tooltip">Certification</div>
                </a>
                <a href="collaboration.html" class="nav-item" data-index="8">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>Collaboration</span>
                    <div class="tooltip">Collaboration</div>
                </a>
                <a href="Pre-OrderDashboard.html" class="nav-item" data-index="8">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"></svg>
                    <span>Books Pre orders</span>
                    <div class="tooltip"></div>
                </a>
                
                <div class="active-bg"></div>
            </nav>
        </div>

        <div class="menu-toggle" id="menuToggle">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </header>
    <div class="dashboard">
        <div class="dashboard-header" style="margin-top: 100px;">
            <h1>Donation Dashboard</h1>
            <button onclick="refreshDashboard()" class="button">Refresh Data</button>
        </div>

        <div id="error" class="error"></div>
        <div id="loader" class="loader"></div>

        <div id="dashboard-content" style="display: none;">
            <div class="stats-container">
                <div class="stat-card total">
                    <h3>Total Donations</h3>
                    <p id="totalAmount">₹0</p>
                    <span class="trend" id="totalTrend">↑ 15% this month</span>
                </div>
                <div class="stat-card monthly">
                    <h3>Donations This Month</h3>
                    <p id="monthlyCount">0</p>
                    <span class="trend" id="monthlyTrend">↑ 8% this month</span>
                </div>
                <div class="stat-card average">
                    <h3>Average Donation</h3>
                    <p id="averageAmount">₹0</p>
                    <span class="trend" id="averageTrend">↑ 3% this month</span>
                </div>
            </div>

            <div class="charts-container">
                <div class="chart-card">
                    <canvas id="donationTypeChart"></canvas>
                </div>
                <div class="chart-card">
                    <canvas id="revenueChart"></canvas>
                </div>
                <div class="chart-card">
                    <canvas id="paymentMethodChart"></canvas>
                </div>
            </div>

            <!-- Filters and Pagination -->
            <div class="filters">
                <label for="statusFilter">Filter by Payment Method:</label>
                <select id="statusFilter" onchange="filterTable()">
                    <option value="all">All</option>
                    <option value="credit_card">Credit Card</option>
                    <option value="upi">UPI</option>
                    <option value="paypal">PayPal</option>
                </select>
            </div>

            <div class="pagination">
                <button onclick="previousPage()">Previous</button>
                <span id="pageInfo">Page 1 of 1</span>
                <button onclick="nextPage()">Next</button>
            </div>

            <!-- Table to display all data -->
            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Donation Amount</th>
                            <th>Custom Amount</th>
                            <th>Donation Type</th>
                            <th>Payment Method</th>
                            <th>Address</th>
                            <th>Donation Pool</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Rows will be dynamically inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Constants
        const API_BASE_URL = 'https://api.khcrf.org/api/donations';
        const authToken = localStorage.getItem('authToken');
        const charts = {
            donationType: null,
            revenue: null,
            paymentMethod: null
        };
    
        let allDonations = []; // Store all donations
        let filteredDonations = []; // Store filtered donations
        let currentPage = 1;
        const itemsPerPage = 3; // Number of items per page
    
        // Fetch all donations
        async function fetchDonations() {
            try {
                const response = await fetch(`${API_BASE_URL}/all`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                if (!response.ok) throw new Error(`Request failed with status ${response.status}`);
                const result = await response.json();
                console.log('API Response:', result); // Log the response
    
                // Ensure the response contains the expected data
                if (!result.data || !Array.isArray(result.data)) {
                    throw new Error('Invalid API response format');
                }
    
                return result.data; // Return the array of donations
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }
    
        // Process donation data
        function processDonationData(donations) {
            const donationTypeCount = {};
            const paymentMethods = {};
            const revenueData = {};
            let totalAmount = 0;
    
            donations.forEach(donation => {
                // Count by donation type
                donationTypeCount[donation.donationType] = (donationTypeCount[donation.donationType] || 0) + 1;
    
                // Count by payment method
                paymentMethods[donation.paymentMethod] = (paymentMethods[donation.paymentMethod] || 0) + 1;
    
                // Revenue data
                const date = new Date(donation.createdAt).toISOString().split('T')[0];
                revenueData[date] = (revenueData[date] || 0) + donation.amount;
    
                // Total amount donated
                totalAmount += donation.amount;
            });
    
            return {
                donationTypeCount,
                paymentMethods,
                revenueData,
                totalAmount,
                averageAmount: donations.length > 0 ? totalAmount / donations.length : 0,
                monthlyCount: donations.length,
                donations // Return raw data for the table
            };
        }
    
        // Create donation type chart
        function createDonationTypeChart(typeData) {
            const ctx = document.getElementById('donationTypeChart').getContext('2d');
            if (charts.donationType) charts.donationType.destroy();
    
            charts.donationType = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(typeData),
                    datasets: [{
                        data: Object.values(typeData),
                        backgroundColor: ['#059669', '#0891b2', '#6366f1', '#8b5cf6', '#ec4899', '#f59e0b'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Donation Types',
                            color: '#e5e7eb',
                            font: { size: 16, weight: '600' }
                        },
                        legend: {
                            position: 'bottom',
                            labels: { color: '#9ca3af' }
                        }
                    }
                }
            });
        }
    
        // Create revenue chart
        function createRevenueChart(revenueData) {
            const ctx = document.getElementById('revenueChart').getContext('2d');
            if (charts.revenue) charts.revenue.destroy();
    
            const dates = Object.keys(revenueData).sort();
            const amounts = dates.map(date => revenueData[date]);
    
            charts.revenue = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'Revenue (₹)',
                        data: amounts,
                        borderColor: '#8b5cf6',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Revenue Over Time',
                            color: '#e5e7eb',
                            font: { size: 16, weight: '600' }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#374151' },
                            ticks: { color: '#9ca3af' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#9ca3af' }
                        }
                    }
                }
            });
        }
    
        // Create payment method chart
        function createPaymentMethodChart(methodData) {
            const ctx = document.getElementById('paymentMethodChart').getContext('2d');
            if (charts.paymentMethod) charts.paymentMethod.destroy();
    
            charts.paymentMethod = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(methodData),
                    datasets: [{
                        data: Object.values(methodData),
                        backgroundColor: ['#059669', '#0891b2', '#6366f1'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Payment Methods',
                            color: '#e5e7eb',
                            font: { size: 16, weight: '600' }
                        },
                        legend: {
                            position: 'bottom',
                            labels: { color: '#9ca3af' }
                        }
                    }
                }
            });
        }
    
        // Populate the table with donation data
        function populateTable(donations) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = ''; // Clear existing rows
    
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedDonations = donations.slice(startIndex, endIndex);
    
            paginatedDonations.forEach(donation => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${donation.id}</td>
                    <td>${donation.firstName} ${donation.lastName}</td>
                    <td><a href="mailto:${donation.email}">${donation.email}</a></td>
                    <td>${donation.phone}</td>
                    <td>₹${donation.amount}</td>
                    <td>${donation.customAmount ? `₹${donation.customAmount}` : "N/A"}</td>
                    <td>${donation.donationType}</td>
                    <td>${donation.paymentMethod}</td>
                    <td>${renderAddress(donation)}</td>
                    <td>${donation.tools || "N/A"}</td>
                    <td>
                        <button onclick="deleteDonation(${donation.id})" class="button reject">Delete</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
    
            // Update pagination info
            document.getElementById('pageInfo').textContent = `Page ${currentPage} of ${Math.ceil(donations.length / itemsPerPage)}`;
        }
    
        // Helper function to render address
        function renderAddress(donation) {
            return `
                ${donation.streetAddress || "N/A"}, ${donation.city || "N/A"}, 
                ${donation.state || "N/A"} ${donation.zip || "N/A"}, ${donation.country || "N/A"}
            `;
        }
    
        // Function to delete a donation
        async function deleteDonation(id) {
            try {
                const response = await fetch(`${API_BASE_URL}/${id}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
    
                if (!response.ok) throw new Error('Failed to delete donation');
                const data = await response.json();
                console.log('Donation deleted:', data);
    
                // Refresh the dashboard to reflect changes
                refreshDashboard();
            } catch (error) {
                console.error('Error deleting donation:', error);
                alert('Failed to delete donation. Please try again.');
            }
        }
    
        // Filter table by payment method
        function filterTable() {
            const paymentFilter = document.getElementById('statusFilter').value;
            if (paymentFilter === 'all') {
                filteredDonations = allDonations;
            } else {
                filteredDonations = allDonations.filter(donation => donation.paymentMethod === paymentFilter);
            }
            currentPage = 1; // Reset to the first page
            populateTable(filteredDonations);
        }
    
        // Pagination: Go to the next page
        function nextPage() {
            const totalPages = Math.ceil(filteredDonations.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                populateTable(filteredDonations);
            }
        }
    
        // Pagination: Go to the previous page
        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                populateTable(filteredDonations);
            }
        }
    
        // Update dashboard with real data
        async function updateDashboard() {
            try {
                const donations = await fetchDonations();
                const processedData = processDonationData(donations);
    
                // Update stats
                document.getElementById('totalAmount').textContent = `₹${processedData.totalAmount.toLocaleString()}`;
                document.getElementById('monthlyCount').textContent = processedData.monthlyCount.toLocaleString();
                document.getElementById('averageAmount').textContent = `₹${processedData.averageAmount.toFixed(2)}`;
    
                // Update charts
                createDonationTypeChart(processedData.donationTypeCount);
                createRevenueChart(processedData.revenueData);
                createPaymentMethodChart(processedData.paymentMethods);
    
                // Store all donations and apply filters
                allDonations = processedData.donations;
                filterTable();
    
                // Show dashboard content
                document.getElementById('dashboard-content').style.display = 'block';
                document.getElementById('loader').style.display = 'none';
                document.getElementById('error').style.display = 'none';
            } catch (error) {
                console.error('Error updating dashboard:', error);
                document.getElementById('error').textContent = 'Failed to load data. Please try again.';
                document.getElementById('error').style.display = 'block';
                document.getElementById('loader').style.display = 'none';
            }
        }
    
        // Refresh dashboard
        function refreshDashboard() {
            document.getElementById('dashboard-content').style.display = 'none';
            document.getElementById('loader').style.display = 'block';
            document.getElementById('error').style.display = 'none';
            updateDashboard();
        }
    
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', () => {
    const authToken = localStorage.getItem('authToken');
    if (!authToken) {
        window.location.href = 'login.html'; // Redirect to login if no token
        return;
    }

    try {
        // Decode the token payload
        const payload = authToken.split('.')[1];
        const decodedToken = JSON.parse(atob(payload));

        console.log('Decoded Token:', decodedToken); // Debug: Log the decoded token

        // Check authorization
        if (decodedToken.isAdmin || decodedToken.role === 'Donation Moderator') {
            console.log('Access Granted');
            refreshDashboard(); // Load the dashboard
        } else {
            alert('Unauthorized access. Admins or Donation Moderators only.');
            window.location.href = '/unauthorized'; // Redirect to unauthorized page
        }
    } catch (error) {
        console.error('Error decoding token:', error);
        alert('Invalid token. Please log in again.');
        window.location.href = 'login.html';
    }
});
        
   </script>

    <script>
        // Get references to the menu toggle and nav links
        const menuToggle = document.getElementById('menuToggle');
        const navLinks = document.getElementById('navLinks');

        // Add click event listener to the menu toggle
        menuToggle.addEventListener('click', () => {
            // Toggle the 'active' class on the nav links
            navLinks.classList.toggle('active');
            // Toggle the 'active' class on the menu toggle for the animation
            menuToggle.classList.toggle('active');
        });
    </script>
</body>
</html>